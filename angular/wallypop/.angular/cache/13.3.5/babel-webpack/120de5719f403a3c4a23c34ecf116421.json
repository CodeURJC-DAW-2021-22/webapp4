{"ast":null,"code":"import { throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/favorites.service\";\nimport * as i2 from \"../../services/login.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app/services/article.service\";\nimport * as i5 from \"@angular/common/http\";\nimport * as i6 from \"@angular/common\";\n\nfunction FavoritesComponent_small_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\");\n    i0.ɵɵtext(1, \"ADMIN\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction FavoritesComponent_span_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\")(1, \"a\", 35);\n    i0.ɵɵelement(2, \"i\", 16);\n    i0.ɵɵtext(3, \" GESTI\\u00D3N CATEGOR\\u00CDAS \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"a\", 36);\n    i0.ɵɵelement(5, \"i\", 16);\n    i0.ɵɵtext(6, \" GESTI\\u00D3N REPORTES \");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction FavoritesComponent_div_51_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 37)(2, \"figure\", 38);\n    i0.ɵɵelement(3, \"img\", 39);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 40)(5, \"a\", 41);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\", 42);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"span\", 43);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"span\", 44);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"a\", 45);\n    i0.ɵɵlistener(\"click\", function FavoritesComponent_div_51_Template_a_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const i_r4 = restoredCtx.index;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.addFavorite(ctx_r5.user.id_USER, ctx_r5.articles[i_r4].id_ARTICLE);\n    });\n    i0.ɵɵelement(14, \"i\", 46);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const favorite_r3 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"/api/favorites/\", favorite_r3.id_FAVORITE, \"/image\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"href\", \"/post/\", ctx_r2.articles[i_r4].id_ARTICLE, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r2.articles[i_r4].title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r2.articles[i_r4].price, \"\\u20AC\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.articles[i_r4].city);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.articles[i_r4].date);\n  }\n}\n\nconst BASE_URL = '/api/';\nexport let FavoritesComponent = /*#__PURE__*/(() => {\n  class FavoritesComponent {\n    constructor(favoriteService, loginService, router, articleService, httpClient) {\n      this.favoriteService = favoriteService;\n      this.loginService = loginService;\n      this.router = router;\n      this.articleService = articleService;\n      this.httpClient = httpClient;\n      this.articles = [];\n    }\n\n    ngOnInit() {\n      this.httpClient.get('/api/users', {\n        withCredentials: true\n      }).subscribe(user => {\n        this.user = user;\n        this.favoriteService.getFavorites(this.loginService.currentUser().id_USER).subscribe(favorite => {\n          this.favorites = favorite;\n          favorite.forEach(value => {\n            this.getArticleFavorite(value.id_FAVORITE).subscribe(response => {\n              this.articles.push(response);\n              this.favorites[this.favorites.indexOf(value)].article = response;\n            });\n          });\n        }, error => console.log(error));\n      }, error => {\n        if (error.status !== 404) {\n          console.error('Error usuario: ' + JSON.stringify(error));\n        }\n      });\n    }\n\n    getArticleFavorite(idFavorite) {\n      return this.httpClient.get(BASE_URL + 'favorites/' + idFavorite + '/article').pipe(catchError(error => this.handleError(error)));\n    }\n\n    getUserFavorite(idFavorite) {\n      return this.httpClient.get(BASE_URL + 'favorites/' + idFavorite + '/user').pipe(catchError(error => this.handleError(error)));\n    }\n\n    refresh() {\n      window.location.reload();\n    }\n\n    addFavorite(idArticle, idUser) {\n      this.favoriteService.addFavorite(idArticle, idUser);\n      this.refresh();\n    }\n\n    handleError(error) {\n      console.log('ERROR:');\n      console.error(error);\n      return throwError('Server error (' + error.status + '): ' + error.text());\n    }\n\n  }\n\n  FavoritesComponent.ɵfac = function FavoritesComponent_Factory(t) {\n    return new (t || FavoritesComponent)(i0.ɵɵdirectiveInject(i1.FavoriteService), i0.ɵɵdirectiveInject(i2.LoginService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.ArticleService), i0.ɵɵdirectiveInject(i5.HttpClient));\n  };\n\n  FavoritesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FavoritesComponent,\n    selectors: [[\"favorites\"]],\n    decls: 78,\n    vars: 7,\n    consts: [[1, \"full-width\", \"section\"], [1, \"container\"], [1, \"row\"], [1, \"col-xs-12\", \"col-sm-4\", \"col-md-3\"], [1, \"full-width\", \"user-menu-xs\", 2, \"text-align\", \"center\"], [1, \"full-width\", \"post-user-info\", 2, \"margin\", \"0 !important\"], [1, \"full-width\"], [4, \"ngIf\"], [\"alt\", \"User\", \"height\", \"auto\", \"src\", \"/assets/img/user.png\", \"width\", \"90px\", 1, \"\", 2, \"border\", \"1px\", \"top\", \"0px\"], [1, \"full-width\", \"div-table\"], [1, \"full-width\", \"div-table-row\"], [1, \"div-table-cell\", \"div-table-cell-xs\", 2, \"height\", \"auto !important\", \"line-height\", \"inherit\", \"border\", \"none\"], [1, \"full-width\", \"list-group\", 2, \"border-radius\", \"0\"], [\"href\", \"/profile\", 1, \"list-group-item\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-user\", \"fa-fw\"], [\"href\", \"/yourcommercial\", 1, \"list-group-item\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-object-group\", \"fa-fw\"], [\"href\", \"/yourcommercialsold\", 1, \"list-group-item\"], [\"href\", \"/favorites\", 1, \"list-group-item\", \"active\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-heart-o\", \"fa-fw\"], [1, \"col-xs-12\", \"col-sm-8\", \"col-md-9\"], [1, \"full-width\", \"bar-info-user\"], [1, \"full-widht\"], [1, \"fa\", \"fa-th-large\", \"btn\", \"btn-default\", \"hidden-xs\", \"btn-change-post\"], [1, \"fa\", \"fa-refresh\", \"btn\", \"btn-default\"], [1, \"fa\", \"fa-angle-right\", \"btn\", \"btn-default\"], [1, \"full-width\", \"container-post\"], [4, \"ngFor\", \"ngForOf\"], [1, \"clearfix\"], [1, \"text-center\"], [1, \"pagination\"], [\"aria-label\", \"Previous\", \"href\", \"#\"], [\"aria-hidden\", \"true\"], [\"href\", \"#\"], [\"aria-label\", \"Next\", \"href\", \"#\"], [\"href\", \"/category\", 1, \"list-group-item\"], [\"href\", \"/reports\", 1, \"list-group-item\"], [1, \"full-width\", \"post\"], [1, \"full-width\", \"post-img\"], [\"alt\", \"\", 1, \"img-responsive\", 3, \"src\"], [1, \"full-width\", \"post-info\"], [1, \"full-width\", \"post-info-title\", 3, \"href\"], [1, \"full-width\", \"post-info-price\"], [1, \"post-info-zone\"], [1, \"post-info-date\"], [3, \"click\"], [1, \"fa\", \"fa-heart-o\", \"post-info-like\"]],\n    template: function FavoritesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"p\", 6);\n        i0.ɵɵtemplate(7, FavoritesComponent_small_7_Template, 2, 0, \"small\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"p\", 6)(9, \"small\");\n        i0.ɵɵtext(10);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(11, \"img\", 8);\n        i0.ɵɵelementStart(12, \"p\", 6)(13, \"small\");\n        i0.ɵɵtext(14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 9)(16, \"div\", 10)(17, \"div\", 11);\n        i0.ɵɵtext(18);\n        i0.ɵɵelement(19, \"br\");\n        i0.ɵɵelementStart(20, \"small\");\n        i0.ɵɵtext(21, \"En venta\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(22, \"div\", 11);\n        i0.ɵɵtext(23);\n        i0.ɵɵelement(24, \"br\");\n        i0.ɵɵelementStart(25, \"small\");\n        i0.ɵɵtext(26, \"Vendidos\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(27, \"div\", 12)(28, \"a\", 13);\n        i0.ɵɵelement(29, \"i\", 14);\n        i0.ɵɵtext(30, \" TU PERFIL\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"a\", 15);\n        i0.ɵɵelement(32, \"i\", 16);\n        i0.ɵɵtext(33, \" TUS ANUNCIOS\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"a\", 17);\n        i0.ɵɵelement(35, \"i\", 16);\n        i0.ɵɵtext(36, \" TUS ANUNCIOS VENDIDOS\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"a\", 18);\n        i0.ɵɵelement(38, \"i\", 19);\n        i0.ɵɵtext(39, \" FAVORITOS\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(40, FavoritesComponent_span_40_Template, 7, 0, \"span\", 7);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(41, \"div\", 20)(42, \"div\", 21);\n        i0.ɵɵelement(43, \"i\", 19);\n        i0.ɵɵelementStart(44, \"div\");\n        i0.ɵɵtext(45, \"FAVORITOS\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(46, \"div\", 22);\n        i0.ɵɵelement(47, \"i\", 23)(48, \"i\", 24)(49, \"i\", 25);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"div\", 26);\n        i0.ɵɵtemplate(51, FavoritesComponent_div_51_Template, 15, 6, \"div\", 27);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(52, \"div\", 28);\n        i0.ɵɵelementStart(53, \"nav\", 29)(54, \"ul\", 30)(55, \"li\")(56, \"a\", 31)(57, \"span\", 32);\n        i0.ɵɵtext(58, \"\\u00AB\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(59, \"li\")(60, \"a\", 33);\n        i0.ɵɵtext(61, \"1\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(62, \"li\")(63, \"a\", 33);\n        i0.ɵɵtext(64, \"2\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(65, \"li\")(66, \"a\", 33);\n        i0.ɵɵtext(67, \"3\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(68, \"li\")(69, \"a\", 33);\n        i0.ɵɵtext(70, \"4\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(71, \"li\")(72, \"a\", 33);\n        i0.ɵɵtext(73, \"5\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(74, \"li\")(75, \"a\", 34)(76, \"span\", 32);\n        i0.ɵɵtext(77, \"\\u00BB\");\n        i0.ɵɵelementEnd()()()()()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", ctx.loginService.isLogged() && ctx.loginService.isAdmin());\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.loginService.currentUser().full_NAME);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.loginService.currentUser().name);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.loginService.currentUser().n_SELL, \" \");\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate1(\" \", ctx.loginService.currentUser().n_SOLD, \" \");\n        i0.ɵɵadvance(17);\n        i0.ɵɵproperty(\"ngIf\", ctx.loginService.isAdmin());\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngForOf\", ctx.favorites);\n      }\n    },\n    directives: [i6.NgIf, i6.NgForOf],\n    encapsulation: 2\n  });\n  return FavoritesComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}